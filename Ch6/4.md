# veloportì™€ í•¨ê»˜í•˜ëŠ” ëª¨ë˜ ë¦¬ì•¡íŠ¸

## 6ì¥ - Redux

### Ducks Patternì„ ì´ìš©í•œ Redux ëª¨ë“ˆ êµ¬í˜„í•˜ê¸° - 1ï¸âƒ£ Counter

> **Ducks Patternì´ë€?** <br>

- Ducksì€ actionsì™€ action typesì™€ reducersë¥¼ í•˜ë‚˜ì˜ íŒŒì¼ì— ë‚˜ë€íˆ ì„ ì–¸í•˜ëŠ” ëª¨ë“ˆëŸ¬ íŒ¨í„´ì´ë‹¤.
- Ducks íŒ¨í„´ì— ì˜í•˜ë©´, ëª¨ë“ˆì€ ë‹¤ìŒê³¼ ê°™ì€ ì¡°ê±´ì„ ì¶©ì¡±í•´ì•¼ í•œë‹¤.
  1. **reducer() í•¨ìˆ˜ëŠ”** ë°˜ë“œì‹œ **export defaultë¡œ export** í•´ì•¼í•œë‹¤.
  2. **action creatorsëŠ” ë°˜ë“œì‹œ í•¨ìˆ˜ë¡œ export** í•´ì•¼ í•œë‹¤.
  3. **actionì€** ë°˜ë“œì‹œ npm-module-or-app/reducer/ACTION_TYPEì— ìˆëŠ” **í˜•ì‹ì„ ì§€ì¼œì„œ ì‘ì„±í•´ì•¼ í•œë‹¤.**
  4. ë§Œì•½ ì™¸ë¶€ ë¦¬ë“€ì„œê°€ ì°¸ì¡°í•´ì•¼ í•˜ê±°ë‚˜ ì¬í™œìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ë©´ **action typesëŠ” UPPER_SNAKE_CASEë¡œ export** í•´ì•¼í•œë‹¤.

ì¶œì²˜ : [Matthew Holman - What is Redux Ducks?](https://medium.com/@matthew.holman/what-is-redux-ducks-46bcb1ad04b7)

> **Redux ëª¨ë“ˆ ë§Œë“¤ê¸°** <br>

```javascript
// src/modules/counter.js

// action type ì„ ì–¸
// ducks patternì—ì„œ action type ì•ì—ëŠ” ì ‘ë‘ì‚¬ë¥¼ ë¶™ì„
// action typeì˜ ìƒìˆ˜ëª…ì¹­ì€ UPPER_SNAKE_CASEë¡œ ì‘ì„±í•¨
const SET_DIFF = `counter/SET_DIFF`;
const INCREASE = `counter/INCREASE`;
const DECREASE = `counter/DECREASE`;

// action creator í•¨ìˆ˜ ì„ ì–¸
// action creator í•¨ìˆ˜ëª…ì€ Camel Caseë¡œ ì‘ì„±í•œë‹¤.
export const setDiff = (diff) => ({ type: SET_DIFF, diff });
export const increase = () => ({ type: INCREASE });
export const decrease = () => ({ type: DECREASE });

// ì´ˆê¸° ìƒíƒœê°’ ì„ ì–¸
const initialState = {
  number: 0,
  diff: 1,
};

// reducer í•¨ìˆ˜ ì„ ì–¸
// reducer í•¨ìˆ˜ëŠ” ë°˜ë“œì‹œ export defaultë¡œ export í•´ì¤€ë‹¤.
export default function counter(state = initialState, action) {
  switch (action.type) {
    case SET_DIFF:
      return {
        ...state,
        diff: action.diff,
      };
    case INCREASE:
      return {
        ...state,
        number: state.number + state.diff,
      };
    case DECREASE:
      return {
        ...state,
        number: state.number - state.diff,
      };
    default:
      return state;
  }
}
```

ë§Œì•½, ì—¬ëŸ¬ê°œì˜ ëª¨ë“ˆì„ ê´€ë¦¬í•œë‹¤ë©´ modules í´ë”ì— ê° ëª¨ë“ˆì„ êµ¬í˜„í•˜ê³ , root ëª¨ë“ˆë¡œ ëª¨ë“  ëª¨ë“ˆì„ ê²°í•©í•´ì„œ export í•´ì¤€ë‹¤.<br>
ğŸ‘‰ğŸ» í´ë”ë³„ë¡œ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ í•„ìˆ˜ì ì´ì§€ëŠ” ì•Šë‹¤.

```javascript
// src/modules/index.js
import { combineReducers } from "redux";
import counter from "./counter";
import todos from "./todos";

// combineReducersë¡œ êµ¬í˜„í•œ ëª¨ë“ˆë“¤ì„ ëª¨ë‘ ê²°í•©í•´ì„œ
// rootReducerë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.
const rootReducer = combineReducers({
  counter,
  todos,
});

export default rootReducer;
```

> **Presentationalê³¼ Container Components êµ¬í˜„** <br>

- **Presentational Components** - Counter Component

```javascript
//  src/components/Counter.js
import React from "react";

// ëª¨ë“  ë‚´ë¶€ ìƒíƒœ ë° dataëŠ” propsë¡œ ë°›ì•„ì˜¨ë‹¤.
function Counter({ number, diff, onIncrease, onDecrease, onSetDiff }) {
  const onChange = (e) => {
    onSetDiff(parseInt(e.target.value, 10));
  };

  return (
    <div>
      <h2>{number}</h2>
      <input type="number" value={diff} onChange={onChange} />
      <button onClick={onIncrease}>+</button>
      <button onClick={onDecrease}>-</button>
    </div>
  );
}

export default Counter;
```

- **Container Components** - CounterContainer Component

```javascript
import React from "react";
import Counter from "../components/Counter";
import { useSelector, useDispatch } from "react-redux";
import { increase, decrease, setDiff } from "../modules/counter";

function CounterContainer() {
  // state : reduxì˜ í˜„ì¬ ìƒíƒœ
  const { number, diff } = useSelector((state) => ({
    number: state.counter.number,
    diff: state.counter.diff,
  }));
  const dispatch = useDispatch();

  // action ê°ì²´ë¥¼ dispatch ì ìš©í•´ì¤€ë‹¤.
  const onIncrease = () => dispatch(increase());
  const onDecrease = () => dispatch(decrease());
  const onSetDiff = (diff) => dispatch(setDiff(diff));

  // reduxë¡œ ì—…ë°ì´íŠ¸ ëœ í˜„ ìƒíƒœ ë° dispatch í•¨ìˆ˜ë“¤ì„ propsë¡œ ì „ë‹¬í•œë‹¤.
  return (
    <Counter
      number={number}
      diff={diff}
      onIncrease={onIncrease}
      onDecrease={onDecrease}
      onSetDiff={onSetDiff}
    />
  );
}

export default CounterContainer;
```

êµ¬í˜„ëœ í•´ë‹¹ ëª¨ë“ˆê³¼ ì»´í¬ë„ŒíŠ¸ëŠ” ì•„ë˜ì™€ ê°™ì€ íë¦„ìœ¼ë¡œ ë™ì‘í•˜ê³  ìˆë‹¤.<br>

<img src="./duck-patterns.png" />

Presentational ComponentëŠ” ëª…ì¹­ê³¼ ë§ê²Œ, ë³´ì´ëŠ” ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ UI ìš”ì†Œë§Œì„ ê³ ë ¤í•œ ì»´í¬ë„ŒíŠ¸ì´ë‹¤. redux ì°½ì‹œìì— ì˜í•˜ë©´ Presentational ComponentëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§„ë‹¤.

- ì–´ë–»ê²Œ ë³´ì¼ê¹Œì— ëŒ€í•´ ì§‘ì¤‘í•œë‹¤.
- ë‚´ë¶€ì— í”„ë¦¬ì   í…Œì´ì…˜ ë° ì»¨í…Œì´ë„ˆ êµ¬ì„± ìš”ì†Œë¥¼ ëª¨ë‘ í¬í•¨ í•  ìˆ˜ ìˆìœ¼ë©° ì¼ë°˜ì ìœ¼ë¡œ ì¼ë¶€ DOM ë§ˆí¬ ì—… ë° ìì²´ ìŠ¤íƒ€ì¼ì´ ìˆë‹¤.
- ì¢…ì¢… this.props.childrenì„ í†µí•´ ë´‰ì‡„ë¥¼ í—ˆìš©í•œë‹¤.
- Flux actionsë‚˜ stores ê°™ì€ ì•±ì˜ ë‚˜ë¨¸ì§€ ë¶€ë¶„ì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ì—†ë‹¤.
- ë°ì´í„°ê°€ ë¡œë“œë˜ê³  ë³€ê²½ë˜ëŠ” ë°©ì‹ì„ ì§€ì •í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.
- propsë¥¼ í†µí•´ì„œë§Œ ë°ì´í„°ì™€ ì½œë°±ì„ ë°›ì•„ì˜¨ë‹¤.
- ìì²´ ìƒíƒœë¥¼ ê±°ì˜ ê°–ì§€ ì•ŠëŠ”ë‹¤.(ë°ì´í„°ê°€ ì•„ë‹Œ UI ìƒíƒœ)
- state, lifecycle hooks, ë˜ëŠ” ìµœì í™”ê°€ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš° í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ë¡œ ì‘ì„±ëœë‹¤.
- Examples: Page, Sidebar, Story, UserInfo, List.
  <br>

Container Componentë„ ëª…ì¹­ì— ë§ê²Œ, í•­ìœ„ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ ì—…ë°ì´íŠ¸ ëœ stateë¥¼ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ ì „ë‹¬í•´ì£¼ëŠ” ì»´í¬ë„ŒíŠ¸ì´ë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ redux ì°½ì‹œìì˜ ë§ì— ì˜í•˜ë©´ Container ComponentëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§„ë‹¤.

- ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ì— ì§‘ì¤‘í•œë‹¤.
- ë‚´ë¶€ì— í”„ë¦¬ì   í…Œì´ì…˜ ë° ì»¨í…Œì´ë„ˆ êµ¬ì„± ìš”ì†Œë¥¼ ëª¨ë‘ í¬í•¨ í•  ìˆ˜ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì¼ë¶€ ë˜í•‘ divë¥¼ ì œì™¸í•˜ê³  ìì²´ DOM ë§ˆí¬ ì—…ì´ ì—†ìœ¼ë©° ìŠ¤íƒ€ì¼ì´ ì—†ë‹¤.
- ë°ì´í„°ì™€ í–‰ìœ„(í•¨ìˆ˜)ë¥¼ presentational ë˜ëŠ” ë‹¤ë¥¸ container ì»´í¬ë„ŒíŠ¸ì— ì œê³µí•œë‹¤.
- Fluxì˜ actionsë¥¼ í˜¸ì¶œí•˜ê³  ì´ë¥¼ presentational ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•œ ì½œë°±ìœ¼ë¡œ ì œê³µí•œë‹¤.
- ë°ì´í„° ì†ŒìŠ¤ë¡œ ì‚¬ìš©ë˜ëŠ” ê²½í–¥ì´ ìˆì–´ ìƒíƒœ ì €ì¥ì´ ìì£¼ ë°œìƒí•œë‹¤. (stateful)
- ìˆ˜ë™ìœ¼ë¡œ ì‘ì„±í•˜ëŠ” ëŒ€ì‹  React Reduxì˜ connect(), Relayì˜ createContainer(), Flux Utilsì˜ Container.create()ì™€ ê°™ì€ ê³ ì°¨ì› ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœë‹¤.
- Examples: UserPage, FollowersSidebar, StoryContainer, FollowedUserList.
  <br>

í•´ë‹¹ íŠ¹ì§•ì— ëŒ€í•œ ë‚´ìš©ì—ëŠ” ì˜ì—­ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë‹ˆ, [ì›ë¬¸](https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0)ì„ ì°¸ê³ í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.

## Reference

- ë²¨ë¡œí¼íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ëª¨ë˜ ë¦¬ì•¡íŠ¸ - 6ì¥ ë¦¬ë•ìŠ¤ ëª¨ë“ˆ ë§Œë“¤ê¸° <https://react.vlpt.us/redux/04-make-modules.html>
- ë²¨ë¡œí¼íŠ¸ì™€ í•¨ê»˜í•˜ëŠ” ëª¨ë˜ ë¦¬ì•¡íŠ¸ - 6ì¥ ì¹´ìš´í„° êµ¬í˜„í•˜ê¸° <https://react.vlpt.us/redux/05-counter.html>
- Matthew Holman - What is Redux Ducks? <https://medium.com/@matthew.holman/what-is-redux-ducks-46bcb1ad04b7>
- Dan Abramov - Presentational and Container Components <https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0>
  <br>

[ğŸ‘ˆğŸ»PREV](https://github.com/ss-won/veloport-react/blob/master/Ch6/3.md) |
[NEXTğŸ‘‰ğŸ»](https://github.com/ss-won/veloport-react/blob/master/Ch6/5.md) <br>
[ëŒì•„ê°€ê¸°](https://github.com/ss-won/veloport-react)
